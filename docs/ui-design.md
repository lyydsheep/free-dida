# UI 界面设计清单与无障碍指南

本文档基于 `requirements.md` 和 `task-item.md` 制定，旨在为 Free-Dida 项目提供详细的 UI 界面设计规范。特别强调无障碍访问（Accessibility, a11y），确保视障用户能够通过屏幕阅读器（Screen Reader）无障碍使用。

## 1. 全局布局 (Global Layout)

### 1.1 应用框架 (App Shell)

- **主要功能**：承载应用的主要内容，提供全局导航和状态反馈。
- **布局结构**：
  - **顶部栏 (Header)**：包含应用标题/Logo（左侧），全局操作按钮（如搜索、同步状态、设置）（右侧）。
  - **主内容区 (Main Content)**：动态渲染当前选中的视图（清单、日历、四象限）。
  - **底部导航栏 (Bottom Navigation)**（移动端优先）：用于在主要视图之间切换。
- **交互元素**：
  - **导航链接**：清单、日历、四象限。点击切换主内容区视图。
  - **同步状态图标**：显示当前数据同步状态（在线/离线/同步中）。
- **无障碍设计 (Accessibility)**：
  - **地标角色 (Landmarks)**：
    - 顶部栏使用 `<header role="banner">`。
    - 主内容区使用 `<main role="main">`，并设置 `id="main-content"` 以支持“跳过导航”链接。
    - 底部导航使用 `<nav role="navigation" aria-label="主导航">`。
  - **导航反馈**：当前激活的导航链接需设置 `aria-current="page"`。
  - **跳过链接**：在页面最开始提供一个隐藏的“跳过导航”链接，按 Tab 键首先聚焦，激活后直接跳转到 `<main>` 内容区。

## 2. 清单视图 (List View)

### 2.1 任务列表界面

- **主要功能**：展示任务列表，支持按日期或优先级分组，快速添加任务。
- **布局结构**：
  - **视图控制栏**：位于顶部，包含分组切换（按日期/按优先级）和排序选项。
  - **任务列表容器**：垂直排列的任务项。
  - **快速添加栏 (Quick Add Bar)**：固定在底部或列表顶部。
- **交互元素**：
  - **分组标题**：如“今天”、“明天”、“P0 紧急”。
  - **任务项 (Task Item)**：
    - **复选框**：左侧，点击切换完成状态。
    - **标题文本**：中间，双击进入行内编辑。
    - **优先级指示器**：颜色标记（红/黄/蓝/灰）。
    - **拖拽手柄**：用于排序。
  - **快速添加输入框**：输入文本，回车创建。
- **用户操作流程**：
  1. 用户浏览列表，通过标题区分不同分组。
  2. 点击复选框完成任务，任务会有划线样式并可能移动到“已完成”区域。
  3. 在输入框输入“买牛奶 !p1 明天”，按回车，列表自动更新。
- **无障碍设计**：
  - **列表结构**：使用 `<ul>` 和 `<li>` 构建列表，分组标题使用 `<h2>` 或 `<h3>`。
  - **复选框**：使用原生 `<input type="checkbox">` 或 `role="checkbox"`，关联 `aria-label` 为任务标题（例如 "标记任务 买牛奶 为已完成"）。
  - **状态变更**：任务完成时，若从列表中移除或改变样式，应通过 `aria-live="polite"` 通知屏幕阅读器“任务已完成”。
  - **拖拽排序**：提供键盘可访问的排序方式（如上下文菜单中的“上移/下移”），因为拖拽对屏幕阅读器用户不友好。
  - **快速添加**：输入框需有 `aria-label="快速添加任务"`，并支持 `aria-autocomplete` 提示 NLP 解析结果。

## 3. 日历看板视图 (Calendar Board View)

### 3.1 水平滚动日历

- **主要功能**：按日期列展示任务，支持水平滑动查看不同日期。
- **布局结构**：
  - **日期列容器**：水平排列的列，每列代表一天。
  - **日期列 (Date Column)**：
    - **列头**：显示日期（如 "2月11日 周三"）和任务统计。
    - **列内任务列表**：垂直排列该日期的任务卡片。
    - **列内添加按钮**：位于列底部，快速在该日期创建任务。
- **交互元素**：
  - **水平滚动**：触摸滑动或鼠标滚轮。
  - **任务卡片**：简略版任务项，可拖拽到其他列修改日期。
- **无障碍设计**：
  - **键盘导航**：
    - 使用左右箭头键在不同日期列之间切换焦点。
    - 使用上下箭头键在同一列的任务之间切换焦点。
  - **列结构**：每列应标识为 `role="region"` 或 `section`，并有 `aria-labelledby` 指向列头日期。
  - **拖拽替代**：任务卡片需提供“移动到...”的菜单选项，以便键盘用户修改日期。
  - **无限滚动**：当焦点到达边缘时自动加载新日期，并通过 `aria-live` 提示“已加载更多日期”。

## 4. 四象限视图 (Eisenhower Matrix View)

### 4.1 四象限矩阵

- **主要功能**：根据重要性和紧急程度将任务分为四类展示。
- **布局结构**：
  - **2x2 网格**：
    - 左上：重要且紧急 (Do First)
    - 右上：重要不紧急 (Schedule)
    - 左下：紧急不重要 (Delegate)
    - 右下：不重要不紧急 (Eliminate)
- **交互元素**：
  - **象限容器**：每个象限是一个独立的列表容器。
  - **任务卡片**：展示任务基本信息。
- **无障碍设计**：
  - **标题层级**：每个象限都有清晰的 `<h2>` 标题，屏幕阅读器用户可以通过标题导航快速跳转。
  - **网格导航**：虽然视觉上是网格，但在 DOM 结构上应为线性的四个区域，遵循逻辑阅读顺序。
  - **说明文本**：为每个象限提供隐藏的辅助说明（`sr-only`），解释该象限的含义（如“重要且紧急，建议立即处理”）。

## 5. 任务详情模态框 (Task Detail Modal)

### 5.1 任务编辑界面

- **主要功能**：查看和编辑任务的所有属性（标题、描述、子任务、优先级、日期）。
- **布局结构**：
  - **模态框容器**：覆盖在主视图之上。
  - **头部**：任务标题（可编辑）、关闭按钮。
  - **主体**：
    - **属性栏**：日期选择器、优先级选择器。
    - **描述区**：Markdown 编辑器/预览区。
    - **子任务列表 (Checklist)**：添加/删除/勾选子任务。
  - **底部**：删除按钮、保存状态提示。
- **交互元素**：
  - **Markdown 编辑器**：支持快捷键格式化。
  - **子任务输入框**：回车添加新子任务。
- **无障碍设计**：
  - **对话框角色**：容器使用 `role="dialog"`，`aria-modal="true"`，并 `aria-labelledby` 指向标题。
  - **焦点管理**：
    - 打开时，焦点自动移动到模态框内的第一个可交互元素（通常是标题输入框或关闭按钮）。
    - 关闭时，焦点返回到触发打开模态框的任务项上。
    - 焦点限制（Focus Trap）：Tab 键循环限制在模态框内部，防止焦点跳出到底层页面。
  - **Esc 关闭**：支持按 Esc 键关闭模态框。
  - **表单标签**：所有输入控件必须有关联的 `<label>` 或 `aria-label`。

## 6. 设置与辅助功能 (Settings & Accessibility)

### 6.1 设置面板

- **主要功能**：主题切换、数据管理、关于信息。
- **交互元素**：
  - **主题切换**：深色/浅色/跟随系统。
  - **数据导出/导入**：JSON 文件操作。
- **无障碍设计**：
  - **高对比度**：确保所有文本和图标的颜色对比度符合 WCAG AA 标准（至少 4.5:1）。
  - **字体大小**：支持浏览器默认字体缩放，不使用固定像素单位（px），推荐使用 rem/em。
  - **状态反馈**：所有操作（如保存设置、导入数据）都应有清晰的视觉和屏幕阅读器反馈。
